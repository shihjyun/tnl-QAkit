<style>
  .noselect {
    -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Safari */
    -khtml-user-select: none; /* Konqueror HTML */
    -moz-user-select: none; /* Old versions of Firefox */
    -ms-user-select: none; /* Internet Explorer/Edge */
    user-select: none; /* Non-prefixed version, currently
                                  supported by Chrome, Edge, Opera and Firefox */
  }

  @media (min-width: 640px) {
    div[class*='width-desk'] {
      width: 68%;
    }
  }
</style>

<script>
  import {
    QAFinalPage,
    QASectionsHeight,
    QAProgress,
    RightAnswerCalc,
    QAProgressArray,
  } from '../stores/QAStatusStore.js'
  import { changeCardSectionHeight, getAllSectionsHeight } from '../utils/helper.js'
  import AnswerMessage from './AnswerMessage.svelte'
  import AnswerHeader from './AnswerHeader.svelte'
  import ContentDataStore from '../stores/ContentDataStore.js'
  import { isMobile } from '../stores/DeviceDetectorStore.js'

  export let questNumber
  export let maxQuestion

  let explainStatus, QASet, Answers
  let answerType = 'answer-normal'
  let userHasClickedAnswer = false

  // check store has fetched content data from GCS
  $: if ($ContentDataStore) {
    QASet = $ContentDataStore['question_sets'][questNumber - 1]
  }

  function checkAnswer(e) {
    const selectedAnswer = e.target.dataset.correct
    Answers = e.target.parentElement.children

    // if user's clicked answer is correct:
    // 1. apply correct style to each answer
    // 2. show corresponded explain text to user
    // 3. add accumulated answer number to QA info
    if (selectedAnswer == 1) {
      userHasClickedAnswer = true
      explainStatus = 'explain_correct'
      e.target.classList.add('answer-correct')
      RightAnswerCalc.update(() => $RightAnswerCalc + 1)
      // update progress array
      QAProgressArray.update((currentData) => {
        let tmpArray = currentData
        tmpArray[questNumber - 1].status = 'correct'
        return tmpArray
      })
    } else {
      e.target.classList.add('answer-wrong')
      userHasClickedAnswer = true
      explainStatus = 'explain_wrong'
      // update progress array
      QAProgressArray.update((currentData) => {
        let tmpArray = currentData
        tmpArray[questNumber - 1].status = 'wrong'
        return tmpArray
      })
    }

    // handle each answer style
    for (let i = 0; i < Answers.length; i++) {
      if (Answers[i].dataset.correct == 1) {
        Answers[i].classList.remove('answer-hover')
        Answers[i].classList.remove('answer-normal')
        Answers[i].classList.add('answer-correct')
      } else {
        Answers[i].style.opacity = 0.3
        Answers[i].classList.remove('answer-hover')
      }
    }

    // unlock next question card
    document.getElementById('qa-no-' + (questNumber + 1)).style.display = 'block'
    QAFinalPage.update(() => questNumber + 1)

    // change section height if expain text is too long
    setTimeout(() => {
      changeCardSectionHeight(questNumber)
      QASectionsHeight.update(() => getAllSectionsHeight())
    }, 200)

    // update question progress
    QAProgress.update(() => questNumber + 1)
  }

  // remove event listener when user clicked
  $: if (userHasClickedAnswer) {
    for (let i = 0; i < Answers.length; i++) {
      Answers[i].removeEventListener('click', checkAnswer)
    }

    // send data to gtm
    if (questNumber == maxQuestion) {
      const dataSendToGTM =
        $QAProgressArray.map((d) => d.question_number + '_' + d.status).join('|') + '|final_' + $RightAnswerCalc
      document.querySelector('#end-card').dataset.gtmLabel = dataSendToGTM
    }
  }
</script>

{#if $ContentDataStore}
  <div class="h-auto-sp sm:h-{userHasClickedAnswer ? 'auto' : 'full'}-sp py-6 sm:pb-24 mx-3">
    <div class="QA-wrapper relative h-full rounded-2xl border-4 border-black bg-white mx-auto pb-0 sm:pb-4">
      {#if userHasClickedAnswer && !$isMobile}
        <div class="absolute w-3.5" style="bottom: 40px; right: 40px">
          {#if questNumber == maxQuestion}
            <svg width="100%" viewBox="0 0 13 221" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M11.84 4.564V4.036L7.796 4.036C7.928 3.736 8.036 3.436 8.132 3.124L7.556 2.992C7.304 3.916 6.836 4.792 6.236 5.392C6.368 5.464 6.608 5.68 6.704 5.776C7.004 5.44 7.292 5.032 7.532 4.564L11.84 4.564ZM8.324 5.152C8.744 5.56 9.212 6.136 9.44 6.532L9.86 6.196C9.644 5.812 9.152 5.26 8.732 4.852L8.324 5.152ZM6.488 4.564V4.036L3.116 4.036C3.272 3.736 3.404 3.424 3.512 3.124L2.948 2.968C2.564 4.06 1.88 5.104 1.124 5.776C1.244 5.896 1.436 6.148 1.52 6.268C1.988 5.812 2.444 5.224 2.828 4.564L6.488 4.564ZM4.856 6.196C4.652 5.836 4.232 5.284 3.848 4.864L3.428 5.164C3.812 5.584 4.232 6.172 4.436 6.532L4.856 6.196ZM9.392 10.696V12.796L3.692 12.796L3.692 10.696L9.392 10.696ZM3.128 13.888H3.692V13.324L9.392 13.324V13.816H9.968V10.168L3.128 10.168L3.128 13.888ZM4.232 8.5C5.072 7.984 5.804 7.408 6.404 6.772C7.052 7.312 7.988 7.936 9.032 8.5L4.232 8.5ZM6.368 5.896C5.396 7.3 3.392 8.536 1.088 9.352C1.22 9.46 1.412 9.688 1.496 9.82C2.408 9.46 3.284 9.064 4.052 8.608V9.016L9.08 9.016V8.524C9.896 8.968 10.784 9.364 11.624 9.652C11.72 9.496 11.9 9.268 12.032 9.148C10.064 8.548 7.868 7.324 6.752 6.388C6.812 6.292 6.884 6.208 6.956 6.112L6.368 5.896ZM10.712 22.784H7.448V21.704H10.712V22.784ZM10.712 24.356H7.448V23.264H10.712V24.356ZM10.712 25.928H7.448L7.448 24.812H10.712V25.928ZM6.908 21.224L6.908 26.408H11.264V21.224H8.912C9.044 20.9 9.164 20.504 9.284 20.132H11.816V19.64H6.404V20.132H8.72C8.636 20.48 8.516 20.888 8.408 21.224H6.908ZM9.584 26.96C10.268 27.404 11.096 28.088 11.492 28.58L11.924 28.268C11.504 27.812 10.688 27.128 9.98 26.708L9.584 26.96ZM7.928 26.696C7.436 27.284 6.632 27.848 5.864 28.22C5.984 28.304 6.2 28.52 6.26 28.616C7.028 28.184 7.904 27.5 8.432 26.852L7.928 26.696ZM5.132 21.104H2.42L2.42 20H5.132V21.104ZM5.132 22.688H2.42V21.56H5.132V22.688ZM5.684 19.532H1.892L1.892 23.156H5.684V19.532ZM8.3 29.072C6.608 29.072 5.168 28.964 4.088 28.436V26.624H6.284V26.132H4.088V24.656H6.488V24.164H1.088V24.656H3.56L3.56 28.124C3.128 27.8 2.768 27.392 2.492 26.852C2.552 26.372 2.6 25.892 2.624 25.424H2.084C2.036 26.912 1.784 28.64 1.028 29.528C1.172 29.612 1.352 29.78 1.436 29.888C1.916 29.312 2.216 28.448 2.384 27.512C3.524 29.276 5.504 29.6 8.3 29.6H11.756C11.792 29.432 11.9 29.192 11.996 29.072H8.3ZM1.64 42.576C1.496 43.596 1.28 44.724 0.992 45.504C1.136 45.552 1.376 45.648 1.484 45.696C1.748 44.94 1.988 43.74 2.156 42.672L1.64 42.576ZM2.96 42.636C3.116 43.5 3.26 44.616 3.296 45.36L3.8 45.276C3.752 44.532 3.596 43.416 3.44 42.552L2.96 42.636ZM4.148 42.408C4.436 43.152 4.724 44.136 4.856 44.772L5.324 44.616C5.204 43.992 4.892 43.032 4.604 42.288L4.148 42.408ZM4.124 39.612C4.292 39.996 4.46 40.452 4.604 40.884L2.12 41.22C3.128 40.116 4.136 38.652 5 37.176L4.484 36.9C4.196 37.428 3.872 37.98 3.548 38.472L1.94 38.64C2.672 37.68 3.404 36.444 4.004 35.232L3.452 34.98C2.9 36.312 1.976 37.716 1.712 38.088C1.448 38.448 1.232 38.712 1.04 38.76C1.112 38.916 1.208 39.192 1.232 39.324C1.388 39.252 1.652 39.192 3.188 39.024C2.66 39.768 2.192 40.38 1.976 40.62C1.628 41.052 1.328 41.352 1.112 41.4C1.184 41.556 1.268 41.844 1.304 41.976C1.52 41.868 1.856 41.784 4.736 41.364C4.82 41.652 4.892 41.916 4.928 42.132L5.456 41.964C5.312 41.34 4.964 40.284 4.628 39.492L4.124 39.612ZM10.556 41.964V44.82H6.716V41.964H10.556ZM6.164 45.876H6.716V45.36H10.556V45.828H11.12V41.424H6.164V45.876ZM11.828 37.236V36.684H8.888L8.888 34.992H8.312L8.312 36.684H5.552V37.236H8.312V39.444H5.924V39.984H11.48V39.444H8.888V37.236H11.828ZM2.876 54.988H6.188V57.124H2.876V54.988ZM10.112 54.988V57.124H6.776V54.988H10.112ZM10.688 57.652V54.448H6.776V52.924H11.576V52.384H6.776V51.016H6.188V52.384H1.448V52.924H6.188V54.448H2.312L2.312 57.652H5.864C4.748 59.056 2.792 60.328 1.064 60.928C1.196 61.048 1.376 61.264 1.46 61.42C3.104 60.772 4.988 59.512 6.188 58.096V61.876H6.776V58.036C7.976 59.488 9.884 60.784 11.612 61.432C11.708 61.276 11.888 61.048 12.02 60.928C10.232 60.34 8.24 59.08 7.112 57.652H10.688ZM11.804 84.468V83.892H1.208V84.468H5.972L5.972 93.864H6.572L6.572 87.192C8.048 87.936 9.776 88.992 10.7 89.676L11.072 89.172C10.1 88.464 8.192 87.348 6.692 86.628L6.572 86.772L6.572 84.468H11.804ZM3.464 103.672C3.008 103.312 2.108 102.784 1.412 102.436L1.076 102.844C1.784 103.216 2.672 103.756 3.128 104.128L3.464 103.672ZM1.976 109.672C2.564 108.604 3.284 107.068 3.812 105.832L3.368 105.496C2.804 106.816 2.012 108.4 1.448 109.324L1.976 109.672ZM1.664 99.556C2.444 100 3.404 100.672 3.884 101.116L4.244 100.66C3.776 100.228 2.792 99.604 2.024 99.172L1.664 99.556ZM10.64 104.224H5.288V106.312C5.288 107.308 5.192 108.628 4.388 109.612C4.508 109.684 4.724 109.864 4.82 109.972C5.684 108.916 5.84 107.416 5.84 106.312V104.716H10.088L10.088 106.888C8.576 107.176 7.076 107.488 6.044 107.668L6.26 108.184C7.34 107.968 8.72 107.668 10.088 107.356V109.204C10.088 109.348 10.04 109.396 9.872 109.408C9.704 109.42 9.128 109.42 8.432 109.396C8.516 109.552 8.588 109.744 8.612 109.9C9.488 109.9 10.004 109.888 10.292 109.792C10.556 109.708 10.64 109.552 10.64 109.192L10.64 104.224ZM6.428 105.928C7.448 106.06 8.732 106.384 9.44 106.66L9.596 106.18C8.912 105.892 7.616 105.616 6.596 105.508L6.428 105.928ZM5.948 99.964H10.028V100.924H7.652L7.652 102.724H5.948L5.948 99.964ZM10.028 102.724H8.168L8.168 101.38H10.028V102.724ZM10.58 102.724V99.472H5.408L5.408 102.724H4.076L4.076 104.608H4.628L4.628 103.216H11.312V104.608H11.864V102.724H10.58ZM9.968 121.856H4.232V120.848H9.968V121.856ZM4.232 124.892V123.812H9.968V124.892H4.232ZM4.232 122.312H9.968V123.344H4.232V122.312ZM11.744 119.312V118.808H5.192C5.372 118.448 5.54 118.064 5.684 117.692H11.036V117.188H5.876C6.008 116.828 6.116 116.48 6.224 116.108C8 116 9.692 115.82 10.856 115.556L10.46 115.136C8.612 115.556 4.868 115.748 1.964 115.796C2.024 115.928 2.072 116.12 2.096 116.252C3.188 116.24 4.4 116.204 5.588 116.144C5.492 116.504 5.384 116.84 5.252 117.188H2.156V117.692H5.072C4.916 118.064 4.736 118.448 4.544 118.808H1.256V119.312H4.268C3.476 120.644 2.408 121.832 1.004 122.66C1.112 122.768 1.292 122.984 1.364 123.092C2.252 122.564 3.02 121.892 3.668 121.136L3.668 125.9H4.232L4.232 125.384H9.968V125.9H10.532V120.344H4.28C4.52 120.02 4.724 119.66 4.928 119.312H11.744ZM1.64 138.576C1.496 139.596 1.28 140.724 0.992 141.504C1.136 141.552 1.376 141.648 1.484 141.696C1.748 140.94 1.988 139.74 2.156 138.672L1.64 138.576ZM2.96 138.636C3.116 139.5 3.26 140.616 3.296 141.36L3.8 141.276C3.752 140.532 3.596 139.416 3.44 138.552L2.96 138.636ZM4.148 138.408C4.436 139.152 4.724 140.136 4.856 140.772L5.324 140.616C5.204 139.992 4.892 139.032 4.604 138.288L4.148 138.408ZM4.124 135.612C4.292 135.996 4.46 136.452 4.604 136.884L2.12 137.22C3.128 136.116 4.136 134.652 5 133.176L4.484 132.9C4.196 133.428 3.872 133.98 3.548 134.472L1.94 134.64C2.672 133.68 3.404 132.444 4.004 131.232L3.452 130.98C2.9 132.312 1.976 133.716 1.712 134.088C1.448 134.448 1.232 134.712 1.04 134.76C1.112 134.916 1.208 135.192 1.232 135.324C1.388 135.252 1.652 135.192 3.188 135.024C2.66 135.768 2.192 136.38 1.976 136.62C1.628 137.052 1.328 137.352 1.112 137.4C1.184 137.556 1.268 137.844 1.304 137.976C1.52 137.868 1.856 137.784 4.736 137.364C4.82 137.652 4.892 137.916 4.928 138.132L5.456 137.964C5.312 137.34 4.964 136.284 4.628 135.492L4.124 135.612ZM10.556 137.964L10.556 140.82H6.716V137.964H10.556ZM6.164 141.876H6.716V141.36H10.556V141.828H11.12L11.12 137.424H6.164L6.164 141.876ZM11.828 133.236V132.684H8.888V130.992H8.312V132.684H5.552V133.236H8.312V135.444H5.924V135.984H11.48V135.444H8.888V133.236H11.828ZM3.056 151.66L3.056 150.136H6.2V151.66H3.056ZM3.056 148.12H6.2V149.632H3.056V148.12ZM10.004 149.632H6.788V148.12H10.004L10.004 149.632ZM10.004 151.66H6.788V150.136H10.004V151.66ZM11.684 153.928V153.388H6.788V152.188H10.592L10.592 147.592H2.468L2.468 152.188H6.2V153.388H1.316L1.316 153.928H5.624C4.52 155.212 2.684 156.4 1.04 156.964C1.172 157.084 1.364 157.288 1.448 157.432C3.116 156.784 5.048 155.488 6.2 154.072L6.2 157.864H6.788L6.788 154.012C7.964 155.404 9.944 156.736 11.576 157.384C11.66 157.24 11.852 157.024 11.984 156.904C10.4 156.352 8.516 155.176 7.388 153.928H11.684Z"
                fill="#9B9B9B"
              />
              <path d="M6 166L6 219" stroke="#B9B9B9" />
              <path d="M1.5 210L6 219.5L10.5 210" stroke="#B9B9B9" />
            </svg>
          {:else}
            <svg width="100%" viewBox="0 0 12 189" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M11.804 4.468V3.892L1.208 3.892V4.468L5.972 4.468L5.972 13.864L6.572 13.864L6.572 7.192C8.048 7.936 9.776 8.992 10.7 9.676L11.072 9.172C10.1 8.464 8.192 7.348 6.692 6.628L6.572 6.772V4.468L11.804 4.468ZM3.464 23.672C3.008 23.312 2.108 22.784 1.412 22.436L1.076 22.844C1.784 23.216 2.672 23.756 3.128 24.128L3.464 23.672ZM1.976 29.672C2.564 28.604 3.284 27.068 3.812 25.832L3.368 25.496C2.804 26.816 2.012 28.4 1.448 29.324L1.976 29.672ZM1.664 19.556C2.444 20 3.404 20.672 3.884 21.116L4.244 20.66C3.776 20.228 2.792 19.604 2.024 19.172L1.664 19.556ZM10.64 24.224H5.288L5.288 26.312C5.288 27.308 5.192 28.628 4.388 29.612C4.508 29.684 4.724 29.864 4.82 29.972C5.684 28.916 5.84 27.416 5.84 26.312L5.84 24.716H10.088V26.888C8.576 27.176 7.076 27.488 6.044 27.668L6.26 28.184C7.34 27.968 8.72 27.668 10.088 27.356L10.088 29.204C10.088 29.348 10.04 29.396 9.872 29.408C9.704 29.42 9.128 29.42 8.432 29.396C8.516 29.552 8.588 29.744 8.612 29.9C9.488 29.9 10.004 29.888 10.292 29.792C10.556 29.708 10.64 29.552 10.64 29.192L10.64 24.224ZM6.428 25.928C7.448 26.06 8.732 26.384 9.44 26.66L9.596 26.18C8.912 25.892 7.616 25.616 6.596 25.508L6.428 25.928ZM5.948 19.964H10.028V20.924H7.652V22.724H5.948V19.964ZM10.028 22.724H8.168V21.38H10.028V22.724ZM10.58 22.724V19.472H5.408V22.724H4.076V24.608H4.628V23.216H11.312V24.608H11.864V22.724H10.58ZM2.54 58.636C2.564 58.288 2.576 57.94 2.576 57.64L2.576 57.184H5.624L5.624 58.636H2.54ZM5.624 55.24V56.692H2.576V55.24H5.624ZM6.176 54.724H2.036L2.036 57.64C2.036 58.864 1.94 60.424 1.124 61.576C1.244 61.636 1.472 61.828 1.556 61.924C2.132 61.144 2.384 60.112 2.492 59.128H5.624V61.06C5.624 61.24 5.576 61.288 5.384 61.288C5.228 61.3 4.64 61.3 3.944 61.276C4.028 61.444 4.1 61.672 4.148 61.816C5 61.816 5.516 61.816 5.804 61.708C6.092 61.612 6.176 61.444 6.176 61.072L6.176 54.724ZM10.328 61.036C10.328 61.216 10.268 61.264 10.076 61.276C9.884 61.288 9.212 61.288 8.42 61.276C8.504 61.432 8.612 61.672 8.648 61.84C9.584 61.84 10.148 61.828 10.484 61.732C10.784 61.624 10.892 61.456 10.892 61.024L10.892 54.448H10.328L10.328 61.036ZM8.444 54.844H7.904L7.904 59.74H8.444L8.444 54.844ZM3.2 51.196C3.668 51.736 4.184 52.492 4.4 52.972L4.952 52.744C4.712 52.264 4.184 51.52 3.704 50.992L3.2 51.196ZM8.78 52.972C9.164 52.432 9.596 51.748 9.944 51.16L9.344 50.932C9.068 51.532 8.564 52.396 8.144 52.972H1.208L1.208 53.512H11.78V52.972H8.78ZM8.72 68.948C8.528 68.432 8.048 67.58 7.604 66.956L7.088 67.172C7.52 67.808 7.988 68.66 8.168 69.2L8.72 68.948ZM3.644 67.04C3.104 67.916 2.06 68.936 1.112 69.572C1.208 69.668 1.364 69.896 1.436 70.028C2.468 69.32 3.56 68.24 4.196 67.244L3.644 67.04ZM3.848 69.716C3.152 71 2.036 72.26 0.944 73.088C1.064 73.196 1.256 73.472 1.316 73.592C1.82 73.184 2.324 72.68 2.792 72.14L2.792 77.876H3.368L3.368 71.432C3.74 70.94 4.088 70.424 4.364 69.908L3.848 69.716ZM8.396 76.928L8.396 73.46H11.24V72.908H8.396V69.872H11.624V69.32H4.628V69.872H7.808V72.908H5.06V73.46H7.808L7.808 76.928H4.292V77.48H11.936V76.928H8.396ZM11.804 84.468V83.892H1.208V84.468H5.972L5.972 93.864H6.572L6.572 87.192C8.048 87.936 9.776 88.992 10.7 89.676L11.072 89.172C10.1 88.464 8.192 87.348 6.692 86.628L6.572 86.772L6.572 84.468H11.804ZM1.088 103.996L1.088 104.632H11.96V103.996H1.088ZM10.712 118.784H7.448L7.448 117.704H10.712V118.784ZM10.712 120.356H7.448V119.264H10.712V120.356ZM10.712 121.928H7.448V120.812H10.712V121.928ZM6.908 117.224L6.908 122.408H11.264V117.224H8.912C9.044 116.9 9.164 116.504 9.284 116.132H11.816L11.816 115.64H6.404V116.132H8.72C8.636 116.48 8.516 116.888 8.408 117.224H6.908ZM9.584 122.96C10.268 123.404 11.096 124.088 11.492 124.58L11.924 124.268C11.504 123.812 10.688 123.128 9.98 122.708L9.584 122.96ZM7.928 122.696C7.436 123.284 6.632 123.848 5.864 124.22C5.984 124.304 6.2 124.52 6.26 124.616C7.028 124.184 7.904 123.5 8.432 122.852L7.928 122.696ZM5.132 117.104H2.42V116H5.132V117.104ZM5.132 118.688H2.42L2.42 117.56H5.132V118.688ZM5.684 115.532H1.892L1.892 119.156H5.684L5.684 115.532ZM8.3 125.072C6.608 125.072 5.168 124.964 4.088 124.436V122.624H6.284V122.132H4.088V120.656H6.488V120.164H1.088V120.656H3.56L3.56 124.124C3.128 123.8 2.768 123.392 2.492 122.852C2.552 122.372 2.6 121.892 2.624 121.424H2.084C2.036 122.912 1.784 124.64 1.028 125.528C1.172 125.612 1.352 125.78 1.436 125.888C1.916 125.312 2.216 124.448 2.384 123.512C3.524 125.276 5.504 125.6 8.3 125.6H11.756C11.792 125.432 11.9 125.192 11.996 125.072H8.3Z"
                fill="#9B9B9B"
              />
              <path d="M6 134L6 187" stroke="#B9B9B9" />
              <path d="M1.5 178L6 187.5L10.5 178" stroke="#B9B9B9" />
            </svg>
          {/if}
        </div>
      {/if}
      <div class="w-full">
        <AnswerHeader {questNumber} {maxQuestion} />
        <div class="flex items-center QA-question-font py-2 mx-3 sm:mx-10 mt-2">
          <div class="hidden sm:block">
            <svg width="106" height="139" viewBox="0 0 19 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M7.856 0.0399995C9.088 0.0399995 10.184 0.256 11.144 0.688C12.104 1.12 12.912 1.704 13.568 2.44C14.224 3.176 14.72 4.032 15.056 5.008C15.408 5.984 15.584 7.008 15.584 8.08C15.584 9.104 15.432 10.096 15.128 11.056C14.824 12 14.368 12.848 13.76 13.6C13.168 14.336 12.432 14.944 11.552 15.424C10.672 15.904 9.656 16.176 8.504 16.24C9.32 16.256 10.04 16.352 10.664 16.528C11.288 16.72 11.872 16.92 12.416 17.128C12.976 17.352 13.528 17.552 14.072 17.728C14.616 17.904 15.2 17.992 15.824 17.992C16.048 17.992 16.312 17.96 16.616 17.896C16.936 17.848 17.272 17.72 17.624 17.512L17.696 17.56L18.032 18.232L18.008 18.328C17.64 18.792 17.192 19.184 16.664 19.504C16.136 19.824 15.544 19.984 14.888 19.984C14.344 19.984 13.784 19.856 13.208 19.6C12.648 19.36 12.056 19.088 11.432 18.784C10.808 18.496 10.16 18.224 9.488 17.968C8.816 17.728 8.112 17.608 7.376 17.608C6.752 17.608 6.144 17.712 5.552 17.92C4.976 18.128 4.552 18.352 4.28 18.592L4.208 18.568L3.944 17.632L3.968 17.56C4.32 17.32 4.792 17.056 5.384 16.768C5.976 16.48 6.616 16.312 7.304 16.264C6.12 16.248 5.08 16.024 4.184 15.592C3.288 15.16 2.536 14.584 1.928 13.864C1.336 13.128 0.888 12.28 0.584 11.32C0.28 10.36 0.128 9.344 0.128 8.272C0.128 7.136 0.304 6.072 0.656 5.08C1.008 4.072 1.512 3.2 2.168 2.464C2.824 1.712 3.632 1.12 4.592 0.688C5.552 0.256 6.64 0.0399995 7.856 0.0399995ZM7.832 14.272C8.616 14.272 9.312 14.112 9.92 13.792C10.544 13.456 11.064 13.016 11.48 12.472C11.896 11.912 12.216 11.264 12.44 10.528C12.664 9.776 12.776 8.976 12.776 8.128C12.776 7.264 12.656 6.464 12.416 5.728C12.192 4.976 11.856 4.328 11.408 3.784C10.976 3.24 10.448 2.816 9.824 2.512C9.2 2.192 8.496 2.032 7.712 2.032C6.944 2.032 6.264 2.184 5.672 2.488C5.08 2.792 4.584 3.216 4.184 3.76C3.784 4.304 3.48 4.952 3.272 5.704C3.064 6.44 2.96 7.24 2.96 8.104C2.96 9.048 3.08 9.904 3.32 10.672C3.56 11.424 3.896 12.072 4.328 12.616C4.76 13.144 5.272 13.552 5.864 13.84C6.456 14.128 7.112 14.272 7.832 14.272Z"
                fill="black"
              />
            </svg>
          </div>
          <div class="noselect ml-4">{QASet.question}</div>
        </div>
        <div class="mt-8">
          {#each QASet.answer as { discription, correct, i }}
            <div
              class="{answerType} rounded-2xl py-3 px-3 mb-3 mx-3 sm:mx-auto cursor-pointer answer-hover width-desk"
              on:click={checkAnswer}
              data-correct={correct}
              answer-index={i}
            >
              {discription}
            </div>
          {/each}
        </div>
        {#if userHasClickedAnswer}
          <AnswerMessage {explainStatus} />
          <div class="noselect text-left text-base sm:border-none pt-6 pb-10 sm:pb-6 mx-3 sm:mx-auto width-desk">
            {@html QASet[explainStatus]}
            {#if QASet.explain_source}
              <p class="pt-3 sm:pt-5 text-sm" style="color: #515151">資料來源：{QASet.explain_source}</p>
            {/if}
          </div>

          {#if $isMobile}
            <div
              class="absolte flex justify-between items-center  bottom-0 w-full rounded-b-lg text-center bg-black py-4"
            >
              <div>
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M10.308 16.7923C9.89735 16.3826 9.89735 15.7179 10.308 15.3073C10.7176 14.8976 11.3823 14.8976 11.793 15.3073L16.0501 19.5653L20.3072 15.3073C20.7178 14.8976 21.3825 14.8976 21.7922 15.3073C22.2028 15.7179 22.2028 16.3826 21.7922 16.7923L16.7925 21.7929C16.3828 22.2026 15.7172 22.2026 15.3075 21.7929L10.308 16.7923ZM10.308 10.7923C9.89735 10.3826 9.89735 9.71788 10.308 9.30726C10.7176 8.89758 11.3823 8.89758 11.793 9.30726L16.0501 13.5653L20.3072 9.30726C20.7178 8.89758 21.3825 8.89758 21.7922 9.30726C22.2028 9.71788 22.2028 10.3826 21.7922 10.7923L16.7925 15.7929C16.3828 16.2026 15.7172 16.2026 15.3075 15.7929L10.308 10.7923Z"
                    fill="white"
                  />
                </svg>
              </div>
              <div class="inline-block text-white">
                {questNumber == maxQuestion ? '答題結束，下滑看結果' : '下滑，前往下一題'}
              </div>
              <div>
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path
                    d="M10.308 16.7923C9.89735 16.3826 9.89735 15.7179 10.308 15.3073C10.7176 14.8976 11.3823 14.8976 11.793 15.3073L16.0501 19.5653L20.3072 15.3073C20.7178 14.8976 21.3825 14.8976 21.7922 15.3073C22.2028 15.7179 22.2028 16.3826 21.7922 16.7923L16.7925 21.7929C16.3828 22.2026 15.7172 22.2026 15.3075 21.7929L10.308 16.7923ZM10.308 10.7923C9.89735 10.3826 9.89735 9.71788 10.308 9.30726C10.7176 8.89758 11.3823 8.89758 11.793 9.30726L16.0501 13.5653L20.3072 9.30726C20.7178 8.89758 21.3825 8.89758 21.7922 9.30726C22.2028 9.71788 22.2028 10.3826 21.7922 10.7923L16.7925 15.7929C16.3828 16.2026 15.7172 16.2026 15.3075 15.7929L10.308 10.7923Z"
                    fill="white"
                  />
                </svg>
              </div>
            </div>
          {/if}
        {/if}
      </div>
    </div>
  </div>
{/if}
